---
title: "Repaso y Simulación Serie"
author: "Brayan Cubides"
toc: true
toc-location: right
toc-depth: 2
#number-sections: true
code-tools: true
lightbox: true
self-contained: false
---

# DISTRIBUCIÓN NORMAL BIVARIADA

Esta sección limpia el entorno, define la secuencia para *x* e *y*, define la función de la distribución normal bivariada y genera el gráfico 3D de la densidad.

```{r}
x<-seq(-6,6,length=40); y<-x

# Función Normal Bivariada
f<-function(x,y,mu=c(0,0),s=c(1,0,1))
{
  mu1<-mu[1]; mu2<-mu[2]
  s11<-s[1]; s12<-s[2]; s22<-s[3]; rho<-s12/(s11*s22)
  term1<-1/(2*pi*sqrt(s11*s22*(1-rho^2)))
  term2<--1/(2*(1-rho^2))
  term3<-(x-mu1)^2/s11
  term4<-(y-mu2)^2/s22
  term5<--2*rho*((x-mu1)*(y-mu2))/(sqrt(s11)*sqrt(s22))
  term1*exp(term2*(term3+term4-term5))
} 

z<-outer(x,y,f,s=c(5,12.5,5)) # matriz de densidades

persp(x, y, z, col="lightsalmon", theta=30, phi=20, r=50, d=0.1, expand=0.5, ltheta=90,
      main="Distribuci?n Normal Bivariada", lphi=180, shade=0.3, ticktype="detailed",
      nticks=5, cex.axis=0.7, zlab='Densidad')
mtext(expression(list(mu[x]==0, mu[y]==0, sigma[x]==5, sigma[y]==5,
                      sigma[xy]==12.5, rho==0.5)), side=3)
```

# DISTRIBUCIÓN NORMAL UNIVARIADA 1

Se explora la normal univariada variando la media y la varianza.

```{r}
# Variando la media de la distribución
par(mfrow=c(1,1))
mu<-c(0,2,4,-5);
curve(dnorm(x), xlim=c(-10,10), main=expression('Distribuci?n Normal '*sigma==1), lwd=2,
      ylab='Densidad')
curve(dnorm(x,2,1), col=2, lwd=2, add=T)
curve(dnorm(x,4,1), col=3, lwd=2, add=T)
curve(dnorm(x,-5,1), col=4, lwd=2, add=T)
for(i in 1:4){ polygon(c(mu[i], mu[i]), c(0, dnorm(mu[i], mu[i], 1)), border=i, lty=4, lwd=2) }
legend('toprigh', lty=1, col=1:4, lwd=2, legend=c(expression(mu==0), expression(mu==2),
                                               expression(mu==4), expression(mu==-5)))
# Variando la varianza de la distribución
sig<-c(1,0.7,2); sig<-cbind(-sig,sig)
curve(dnorm(x), lwd=2, ylim=c(0,0.6), xlim=c(-5,5), ylab='Densidad',
      main=expression('Distribuci?n Normal '*mu==0))
curve(dnorm(x,0,sig[2,2]), col=2, lwd=2, add=T)
curve(dnorm(x,0,sig[3,2]), col=3, lwd=2, add=T)
for(i in 1:3){ polygon(sig[i,], dnorm(sig[i,],0,sig[i,2]), border=i, lty=4, lwd=2) }
legend('toprigh', lty=1, col=1:3, lwd=2, legend=c(expression(sigma==1), expression(sigma==0.7),
                                                expression(sigma==2)))

library(moments)
kurtosis(dnorm(x))
kurtosis(dnorm(x,0,sig[2,2]))
kurtosis(dnorm(x,0,sig[3,2]))
```

# DISTRIBUCIÓN NORMAL UNIVARIADA 2

En esta sección se simulan datos normales, se trazan la serie, el histograma, la curva teórica y la estimación de densidad, además de visualizar la distribución acumulada y calcular algunos momentos.

```{r}
x1<- rnorm(1000, mean=0, sd=1)
par(mfrow=c(1,1))
plot(x1, type="l")
hist(x1, freq=FALSE, xlim=c(-4, 4))
curve(dnorm(x), add=T, col="blue")
lines(density(x1), lwd=2, col="darkred")

plot(pnorm(seq(-4,4, length.out=1000)), col=2, ylab="", main="Distribucion Acumulada")

# Momentos de una variable:
library(moments)
media    <- mean(x1)
varianza <- var(x1)
sesgo    <- skewness(x1)
curtosis <- kurtosis(x1)

media  
varianza 
sesgo  
curtosis
```
